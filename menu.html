<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Game Menu</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/howler@2.2.4/dist/howler.min.js"></script>

<style>
body{
  background:#f8f9fa;
}
.menu-wrap{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card{
  width:100%;
  max-width:420px;
  border-radius:16px;
  animation:fadeIn .4s ease;
}
@keyframes fadeIn{
  from{opacity:0;transform:scale(.95)}
  to{opacity:1}
}
</style>
</head>

<body>

<div class="menu-wrap">
  <div class="card shadow-sm p-4">
    <h4 id="gameTitle" class="fw-bold mb-1"></h4>
    <p id="gameSub" class="text-muted mb-4"></p>

    <div class="form-check form-switch mb-3">
      <input class="form-check-input" type="checkbox" id="timerToggle" checked>
      <label class="form-check-label">Enable Timer</label>
    </div>

    <div class="form-check form-switch mb-4">
      <input class="form-check-input" type="checkbox" id="soundToggle" checked>
      <label class="form-check-label">Sound On</label>
    </div>

    <button class="btn btn-primary w-100 mb-2" onclick="handleStart()">
      Start Game
    </button>

    <button class="btn btn-outline-secondary w-100" onclick="handleBack()">
      Back
    </button>
  </div>
</div>

<script>
const params = new URLSearchParams(location.search);
const gameKey = params.get('game');

const gameConfig = {
  sprint:{
    title:'Sprint Quiz',
    sub:'Answer fast before time runs out',
    url:'games/sprint.html'
  },
  puzzle:{
    title:'Puzzle Game',
    sub:'Solve smart image puzzles',
    url:'puzzle/pattern.html'
  }
};

// set UI safely
if(gameConfig[gameKey]){
  gameTitle.innerText = gameConfig[gameKey].title;
  gameSub.innerText   = gameConfig[gameKey].sub;
}

// click sound
const clickSound = new Howl({
  src:['assets/sound/click.mp3'],
  volume:0.5,
  html5:true
});

/* PLAY CLICK SOUND SAFELY */
function playClick(){
  if(!soundToggle.checked) return;

  clickSound.stop();   // ðŸ”´ important
  clickSound.play();
}

/* START GAME */
function handleStart(){
  playClick();

  localStorage.setItem('timerOn', timerToggle.checked ? '1':'0');
  localStorage.setItem('soundOn', soundToggle.checked ? '1':'0');

  // ðŸ”´ delay navigation so sound always plays
  setTimeout(()=>{
    location.href = gameConfig[gameKey].url;
  }, 180);
}

/* BACK */
function handleBack(){
  playClick();
  setTimeout(()=>history.back(), 150);
}
</script>

</body>
</html>

