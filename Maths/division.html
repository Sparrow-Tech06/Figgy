<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no,viewport-fit=cover">
  <meta name="google" content="notranslate">
  
  <title> Division Math </title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>

  <!-- Vue.js CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"/>

  <link rel="stylesheet" href="styles.css?v=170825">

</head>
<body oncontextmenu= "return false">

<div id="app">
  <!-- Header -->
  <nav class="navbar shadow-sm">
    <div class="container-fluid">
      <a onclick="return false;" class="btn btn-light rounded-circle back-link">
        <i class="bi bi-arrow-left"></i>
      </a>
      <span class="navbar-brand mb-0 h5 fw-bold"> </span>
    </div>
  </nav>

  <!-- Quiz Card -->
  <div class="quiz-card">
    <div class="mb-3 text-end">
      <span class="badge bg-danger">Today Quiz</span>
      <span class="badge bg-success">{{ todayCount }}</span>
    </div>

    <div class="question-box mb-3">
      <transition name="fade-slide" mode="out-in">
        <span :key="num1 + '-' + num2">
          What is Result of {{ num1 }} Ã· {{ num2 }} ?
        </span>
      </transition>
    </div>

    <input type="number" class="form-control answer-input mt-5 mb-3" placeholder="Enter answer" v-model="userAnswer"/>

    <!-- Buttons Row -->
    <div class="row g-2">
      <div class="col-8">
        <button class="btn btn-green w-100 fw-semibold" @click="checkAnswer">
          <i class="bi bi-check-circle me-1"></i> Submit
        </button>
      </div>
      <div class="col-4">
        <button class="btn btn-yellow w-100 fw-semibold" :disabled="hintCooldown > 0" @click="showHint">
          <i class="bi bi-lightbulb me-1"></i>
          {{ hintCooldown > 0 ? 'Hint (' + hintCooldown + 's)' : 'Hint' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Snackbar -->
  <div :class="['text-white', snackbarClass, showSnackbarClass]" id="snackbar">
    <i :class="snackbarIcon + ' me-1'"></i> {{ snackbarMessage }}
  </div>

  <!-- Well Done Modal -->
  <div class="modal fade" id="wellDoneModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered position-relative">
      <canvas class="confetti"></canvas>
      <div class="modal-content text-center p-4">
        <div class="congrats-container">
          <div class="wave wave-1"></div>
          <div class="wave wave-2"></div>
          <img src="https://img.icons8.com/color/96/000000/confetti.png" alt="Congrats" class="congrats-img" />
        </div>
        <h4 class="mt-2 fw-bold text-green">Well Done!</h4>
        <p>You solved it correctly ðŸŽ‰</p>
        <button class="btn btn-green w-100" @click="nextQuestion">
          <i class="bi bi-arrow-right-circle me-1"></i> Next Question
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- Our back to confirm script -->
<script src="backConfirm.js"></script>
<!-- All Ways check new version -->
<script src="versionchecker.js"></script>
  
<script>
const { createApp } = Vue;

createApp({
  data() {
    return {
      num1: 0,
      num2: 0,
      userAnswer: '',
      todayCount: 0,
      modalInstance: null,
      hintCooldown: 0,
      hintTimer: null,
      snackbarMessage: '',
      snackbarClass: 'bg-danger',
      snackbarIcon: 'bi-x-circle',
      showSnackbarClass: ''
    }
  },
  methods: {
    generateQuestion() {
      this.num1 = Math.floor(Math.random() * 41) + 10; // 10â€“50
      this.num2 = Math.floor(Math.random() * 9) + 1;   // 1â€“9
      this.userAnswer = '';
    },
    checkAnswer() {
      let correctAnswer = Math.floor(this.num1 / this.num2);
      if (parseInt(this.userAnswer) === correctAnswer) {
        this.todayCount++;
        localStorage.setItem('quizCount', this.todayCount);
        localStorage.setItem('quizDate', new Date().toDateString());

        this.modalInstance = new bootstrap.Modal(document.getElementById('wellDoneModal'));
        this.modalInstance.show();
        this.launchConfetti();
      } else {
        this.showSnackbar("Wrong Answer! Try Again.", "error");
      }
    },
    nextQuestion() {
      this.modalInstance.hide();
      this.generateQuestion();
    },
    showSnackbar(message = "Wrong Answer!", type = "error") {
      this.snackbarMessage = message;
      this.snackbarClass = type === "hint" ? 'bg-success' : 'bg-danger';
      this.snackbarIcon = type === "hint" ? 'bi-lightbulb' : 'bi-x-circle';
      this.showSnackbarClass = "show";

      setTimeout(() => { this.showSnackbarClass = ''; }, 3000);
    },
    launchConfetti() {
      const canvas = document.querySelector('.confetti');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const confettiPieces = [];
      for (let i = 0; i < 80; i++) {
        confettiPieces.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height - canvas.height,
          w: 6,
          h: 6,
          color: `hsl(${Math.random() * 360}, 100%, 50%)`,
          speed: Math.random() * 3 + 2
        });
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        confettiPieces.forEach(p => {
          ctx.fillStyle = p.color;
          ctx.fillRect(p.x, p.y, p.w, p.h);
        });
      }

      function update() {
        confettiPieces.forEach(p => {
          p.y += p.speed;
          if (p.y > canvas.height) p.y = -10;
        });
      }

      function loop() {
        draw();
        update();
        requestAnimationFrame(loop);
      }

      loop();
      setTimeout(() => { ctx.clearRect(0, 0, canvas.width, canvas.height); }, 3000);
    },
    checkReset() {
      let savedDate = localStorage.getItem('quizDate');
      let today = new Date().toDateString();
      if (savedDate !== today) {
        this.todayCount = 0;
        localStorage.setItem('quizCount', 0);
        localStorage.setItem('quizDate', today);
      } else {
        this.todayCount = parseInt(localStorage.getItem('quizCount')) || 0;
      }
    },
    showHint() {
      if (this.hintCooldown > 0) return;
      this.showSnackbar(`Hint: ${Math.floor(this.num1 / this.num2)}`, "hint");
      this.hintCooldown = 10;
      this.hintTimer = setInterval(() => {
        this.hintCooldown--;
        if (this.hintCooldown === 0) {
          clearInterval(this.hintTimer);
          this.hintTimer = null;
        }
      }, 1000);
    }
  },
  mounted() {
    this.checkReset();
    this.generateQuestion();
  }
}).mount('#app');
</script>

</body>
</html>
