<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sprint Duel</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/howler@2.2.4/dist/howler.min.js"></script>

<style>
body{background:#0e0f13;color:#fff}
.card{background:#151821;border:1px solid #1f2433;border-radius:16px}
.option{background:#0e111b;border:1px solid #252a3d;padding:14px;border-radius:14px}
.correct{background:#0f5132}
.wrong{background:#842029}
</style>
</head>

<body>
<div class="container py-3">

<div class="card p-3 mb-3">
  <div class="d-flex justify-content-between">
    <span>Score: <b id="score">0</b></span>
    <span id="timerBox">‚è± <b id="timer">40</b>s</span>
  </div>
  <div class="text-secondary" id="progress">1 / 10</div>
</div>

<div class="card p-3">
  <h4 class="text-center" id="q"></h4>
  <div class="row g-3 mt-2" id="opt"></div>

  <button id="submitBtn"
    class="btn btn-outline-danger w-100 mt-3"
    onclick="endGame()">Submit & End</button>
</div>

</div>

<script>
/* SETTINGS */
const timerOn = localStorage.getItem('timerOn') === 'true';
const soundOn = localStorage.getItem('soundOn') === 'true';

/* SOUNDS */
const sndCorrect = new Howl({src:['assets/sound/correct.mp3'],volume:.6});
const sndWrong   = new Howl({src:['assets/sound/wrong.mp3'],volume:.6});

if(!timerOn){
  document.getElementById('timerBox').style.display='none';
}else{
  document.getElementById('submitBtn').style.display='none';
}

/* GAME DATA */
const data=[
 {q:'2 4 6 ?',a:8,o:[6,8,10,12]},
 {q:'1 4 9 ?',a:16,o:[12,16,18,25]}
];

let i=0,score=0,total=10,timer;

/* TIMER */
if(timerOn){
  let t=40;
  timer=setInterval(()=>{
    t--;
    document.getElementById('timer').textContent=t;
    if(t<=0) endGame();
  },1000);
}

/* LOAD */
function load(){
  if(i>=total){ endGame(); return; }

  const d=data[Math.floor(Math.random()*data.length)];
  document.getElementById('q').textContent=d.q;
  document.getElementById('progress').textContent=`${i+1} / ${total}`;

  const box=document.getElementById('opt');
  box.innerHTML='';
  d.o.forEach(v=>{
    const c=document.createElement('div');
    c.className='col-6';
    c.innerHTML=`<div class="option">${v}</div>`;
    c.onclick=()=>{
      if(v===d.a){
        score++;
        if(soundOn) sndCorrect.play();
      }else{
        if(soundOn) sndWrong.play();
      }
      document.getElementById('score').textContent=score;
      i++;
      setTimeout(load,400);
    };
    box.appendChild(c);
  });
}
load();

/* END */
function endGame(){
  clearInterval(timer);
  localStorage.setItem('gameResult',JSON.stringify({
    score,total,mode:timerOn?'Timer':'Practice'
  }));
  location.href='../result.html';
}
</script>
</body>
</html>
