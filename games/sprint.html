<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sprint Quiz</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/howler@2.2.4/dist/howler.min.js"></script>

<style>
body{background:#fff}
.option{cursor:pointer}
</style>
</head>

<body>

<div class="container py-4">
  <div class="d-flex justify-content-between mb-3">
    <div>⏱ <span id="time">30</span>s</div>
    <div>Score: <span id="score">0</span>/10</div>
  </div>

  <h5 id="question"></h5>

  <div id="options" class="mt-3"></div>
</div>

<script>
// ===== guard =====
if(localStorage.getItem('timerOn') === null){
  location.href = '../menu.html?game=sprint';
}

// ===== sounds =====
const soundOn = localStorage.getItem('soundOn') === '1';

const correctS = new Howl({
  src:['../assets/sound/correct.mp3'],
  volume:0.8
});
const wrongS = new Howl({
  src:['../assets/sound/wrong.mp3']
});

// ===== quiz =====
let qIndex = 0;
let score = 0;
let time = 30;
let timer;

const questions = [
 {q:'5 + 5 ?', a:['8','10','12'], c:1},
 {q:'10 - 3 ?', a:['6','7','8'], c:1},
 {q:'4 × 2 ?', a:['6','8','10'], c:1},
 {q:'9 ÷ 3 ?', a:['2','3','4'], c:1},
 {q:'7 + 2 ?', a:['8','9','10'], c:1},
 {q:'6 + 4 ?', a:['9','10','11'], c:1},
 {q:'8 - 3 ?', a:['4','5','6'], c:1},
 {q:'3 × 3 ?', a:['6','8','9'], c:2},
 {q:'12 ÷ 4 ?', a:['2','3','4'], c:1},
 {q:'2 + 8 ?', a:['9','10','11'], c:1}
];

function loadQ(){
  if(qIndex >= questions.length){
    endGame();
    return;
  }

  const q = questions[qIndex];
  document.getElementById('question').innerText = q.q;

  let html='';
  q.a.forEach((opt,i)=>{
    html+=`<div class="option border rounded p-2 mb-2"
      onclick="check(${i})">${opt}</div>`;
  });
  document.getElementById('options').innerHTML = html;
}

function check(i){
  const q = questions[qIndex];
  if(i === q.c){
    score++;
    soundOn && correctS.play();
  }else{
    soundOn && wrongS.play();
  }

  document.getElementById('score').innerText = score;

  qIndex++;

  // ✅ BUG FIX — all questions done before timer
  if(qIndex === questions.length){
    endGame();
  }else{
    loadQ();
  }
}

function startTimer(){
  if(localStorage.getItem('timerOn') !== '1') return;

  timer = setInterval(()=>{
    time--;
    document.getElementById('time').innerText = time;
    if(time <= 0){
      endGame();
    }
  },1000);
}

function endGame(){
  clearInterval(timer);
  alert(`Game Over\nScore: ${score}/10`);
}

loadQ();
startTimer();
</script>

</body>
</html>
