<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sprint Duels</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>

<style>
body{font-family:Poppins,sans-serif;background:#fff}
.card{max-width:420px;margin:30px auto}
</style>
</head>
<body>

<div class="card p-4 shadow-sm">
<div class="d-flex justify-content-between mb-2">
<span id="timerBox"></span>
<span id="scoreBox">0</span>
</div>

<h4 id="question"></h4>
<div id="options"></div>
</div>

<script>
// üîí menu guard
if(localStorage.getItem("timerOn")===null){
 location.href="../menu.html?game=sprint";
}

// üîä sounds
const soundOn = localStorage.getItem("soundOn")==="true";
const correct = new Howl({src:["../assets/sound/correct.mp3"]});
const wrong   = new Howl({src:["../assets/sound/wrong.mp3"]});
const click   = new Howl({src:["../assets/sound/click.mp3"]});

let timerOn = localStorage.getItem("timerOn")==="true";
let time=30, score=0, total=10, current=0, interval;

// ‚è± Timer
if(timerOn){
 timerBox.innerText=`‚è± ${time}s`;
 interval=setInterval(()=>{
  time--;
  timerBox.innerText=`‚è± ${time}s`;
  if(time<=0) endGame();
 },1000);
}else{
 timerBox.innerText="No Timer";
}

// üß† Game Logic
function generate(){
 if(current>=total){
  endGame();
  return;
 }

 current++;
 let a=Math.floor(Math.random()*10);
 let b=Math.floor(Math.random()*10);
 let ans=a+b;

 question.innerText=`${a} + ${b} = ?`;
 options.innerHTML="";

 let correctPos=Math.floor(Math.random()*4);

 for(let i=0;i<4;i++){
  let val=i===correctPos?ans:ans+Math.floor(Math.random()*5)+1;
  let btn=document.createElement("button");
  btn.className="btn btn-outline-primary w-100 mb-2";
  btn.innerText=val;
  btn.onclick=()=>{
   if(soundOn) click.play();
   if(val===ans){
    score++;
    scoreBox.innerText=score;
    if(soundOn) correct.play();
   }else{
    if(soundOn) wrong.play();
   }
   generate();
  };
  options.appendChild(btn);
 }
}

function endGame(){
 clearInterval(interval);

 // üî• result data save
 localStorage.setItem("lastScore",score);
 localStorage.setItem("lastTotal",total);
 localStorage.setItem("lastGame","Sprint Duels");

 location.href="https://sparrow-tech06.github.io/Figgy/result.html";
}

generate();
</script>
</body>
</html>
